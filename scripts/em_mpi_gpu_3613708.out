---------------------------------------
Begin Slurm Prolog: Nov-21-2025 21:43:56
Job ID:    3613708
User ID:   cpei6
Account:   phys
Job name:  em_mpi_gpu
Partition: ice-gpu
QOS:       coc-ice
---------------------------------------

Lmod is automatically replacing "mvapich2/2.3.7-1" with "openmpi/4.1.5".


Due to MODULEPATH changes, the following have been reloaded:
  1) gmp/6.2.1     2) mpc/1.3.1     3) mpfr/4.2.0     4) zlib/1.2.13

Running MPI+GPU EM...
[load_data] Loading data/processed/doc_term.npz ...
[load_data] Loading data/processed/doc_term.npz ...
[load_data] Loading data/processed/doc_term.npz ...
[load_data] Loading data/processed/doc_term.npz ...
[load_data] Matrix shape = (51282, 20981)
[load_data] Matrix shape = (51282, 20981)
[load_data] Matrix shape = (51282, 20981)
[load_data] Matrix shape = (51282, 20981)
[rank 0] docs 0:13736 (D_local=13736, nnz=299878)
[rank 1] docs 13736:26749 (D_local=13013, nnz=299882)
[rank 3] docs 39380:51282 (D_local=11902, nnz=299824)
[rank 2] docs 26749:39380 (D_local=12631, nnz=299893)
[rank local=1] Using device cuda:1
[rank local=3] Using device cuda:3
[rank local=0] Using device cuda:0
[rank local=2] Using device cuda:2

[EM iter 1/30] log-likelihood = -14565389.8422

[EM iter 2/30] log-likelihood = -12167643.0488
[iter 2] relative change = 1.646195e-01

[EM iter 3/30] log-likelihood = -12002568.6195
[iter 3] relative change = 1.356667e-02

[EM iter 4/30] log-likelihood = -11877594.1613
[iter 4] relative change = 1.041231e-02

[EM iter 5/30] log-likelihood = -11785676.4165
[iter 5] relative change = 7.738751e-03

[EM iter 6/30] log-likelihood = -11720730.6220
[iter 6] relative change = 5.510570e-03

[EM iter 7/30] log-likelihood = -11675196.0143
[iter 7] relative change = 3.884963e-03

[EM iter 8/30] log-likelihood = -11641757.3423
[iter 8] relative change = 2.864078e-03

[EM iter 9/30] log-likelihood = -11617003.2707
[iter 9] relative change = 2.126317e-03

[EM iter 10/30] log-likelihood = -11598142.8711
[iter 10] relative change = 1.623517e-03

[EM iter 11/30] log-likelihood = -11583199.3605
[iter 11] relative change = 1.288440e-03

[EM iter 12/30] log-likelihood = -11570869.8001
[iter 12] relative change = 1.064435e-03

[EM iter 13/30] log-likelihood = -11561243.0488
[iter 13] relative change = 8.319816e-04

[EM iter 14/30] log-likelihood = -11553298.2791
[iter 14] relative change = 6.871899e-04

[EM iter 15/30] log-likelihood = -11546328.5092
[iter 15] relative change = 6.032710e-04

[EM iter 16/30] log-likelihood = -11540634.0625
[iter 16] relative change = 4.931825e-04

[EM iter 17/30] log-likelihood = -11535413.8671
[iter 17] relative change = 4.523318e-04

[EM iter 18/30] log-likelihood = -11530833.3609
[iter 18] relative change = 3.970821e-04

[EM iter 19/30] log-likelihood = -11527006.7104
[iter 19] relative change = 3.318624e-04

[EM iter 20/30] log-likelihood = -11523646.8334
[iter 20] relative change = 2.914787e-04

[EM iter 21/30] log-likelihood = -11520210.3247
[iter 21] relative change = 2.982136e-04

[EM iter 22/30] log-likelihood = -11517409.3342
[iter 22] relative change = 2.431371e-04

[EM iter 23/30] log-likelihood = -11515245.4222
[iter 23] relative change = 1.878818e-04

[EM iter 24/30] log-likelihood = -11513007.1787
[iter 24] relative change = 1.943722e-04

[EM iter 25/30] log-likelihood = -11510593.9376
[iter 25] relative change = 2.096100e-04

[EM iter 26/30] log-likelihood = -11508460.4219
[iter 26] relative change = 1.853524e-04

[EM iter 27/30] log-likelihood = -11506480.3823
[iter 27] relative change = 1.720508e-04

[EM iter 28/30] log-likelihood = -11504943.1084
[iter 28] relative change = 1.336007e-04

[EM iter 29/30] log-likelihood = -11503295.6394
[iter 29] relative change = 1.431966e-04

[EM iter 30/30] log-likelihood = -11501538.9344
[iter 30] relative change = 1.527132e-04
[rank 0] Saved parameters and timings to data/processed/em_mpi_gpu_K20_P4_balanced.npz
---------------------------------------
Begin Slurm Epilog: Nov-21-2025 21:44:59
Job ID:        3613708
User ID:       cpei6
Account:       phys
Job name:      em_mpi_gpu
Resources:     cpu=16,gres/gpu:l40s=4,mem=64G,node=1
Rsrc Used:     cput=00:17:04,vmem=0,walltime=00:01:04,mem=3059492K,energy_used=0
Partition:     ice-gpu
QOS:           coc-ice
Nodes:         atl1-1-03-004-21-0
---------------------------------------
